<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Register as Patient</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        body {
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: stretch;
            background: #f4f8fc;
        }
        .form-side {
            min-width: 400px;
            width: 40%;
            max-width: 480px;
            background: rgba(255,255,255,0.93);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 24px rgba(0,0,0,0.09);
            position: relative;
            z-index: 2;
        }
        .form-container {
            width: 100%;
            padding: 2.5rem 2rem;
        }
        .form-title {
            font-weight: 700;
            font-size: 2rem;
            color: #124c78;
            letter-spacing: 0.04em;
            margin-bottom: 1.6rem;
        }
        .background-img-side {
            flex: 1;
            background: url('https://images.unsplash.com/photo-1519494080410-f9aa79b8ae3c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8bWVkaWNhbCUyMGJhY2tncm91bmR8ZW58MHx8MHx8&auto=format&fit=crop&w=900&q=80') center center / cover no-repeat;
            filter: brightness(0.93) contrast(1.02);
        }
        .next-btn { float: right; }
        .back-btn { float: left; }
        .form-step { display: none; }
        .form-step.active { display: block; }
        .gender-select label { margin-right: 1.5rem; }
    </style>
</head>
<body>

<div class="form-side">
    <div class="form-container">
        <h2 class="form-title">Patient Sign Up</h2>
        <!-- Bind to the single DTO wrapper DTO object 'form' -->
        <form method="post" action="/register/patient" th:object="${form}" autocomplete="off">
            <!-- Step 1: Basic Info -->
            <div class="form-step active" id="step1">
                <div class="mb-3">
                    <label class="form-label">Full Name</label>
                    <input type="text" th:field="*{user.fullName}" required class="form-control"/>
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" th:field="*{user.email}" required class="form-control"/>
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" th:field="*{user.password}" required class="form-control"/>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phone Number</label>
                    <input type="text" th:field="*{user.phoneNumber}" required class="form-control"/>
                </div>
                <div class="mb-3">
                    <label class="form-label">Age</label>
                    <input type="number" th:field="*{patientProfile.age}" min="0" max="120" required class="form-control"/>
                </div>
                <div class="mb-3">
                    <label class="form-label me-3">Gender</label>
                    <div class="gender-select form-check form-check-inline">
                        <input class="form-check-input" type="radio" th:field="*{patientProfile.gender}" name="gender" id="genderM" value="Male" required>
                        <label class="form-check-label" for="genderM">Male</label>
                        <input class="form-check-input" type="radio" th:field="*{patientProfile.gender}" name="gender" id="genderF" value="Female">
                        <label class="form-check-label" for="genderF">Female</label>
                        <input class="form-check-input" type="radio" th:field="*{patientProfile.gender}" name="gender" id="genderO" value="Other">
                        <label class="form-check-label" for="genderO">Other</label>
                    </div>
                </div>
                <button type="button" class="btn btn-primary next-btn" onclick="nextStep()">Next</button>
            </div>
            <!-- Step 2: Address & Payment -->
            <div class="form-step" id="step2">
                <div class="mb-3 row">
                    <div class="col-6">
                        <label class="form-label">City</label>
                        <input type="text" th:field="*{patientProfile.city}" class="form-control" required/>
                    </div>
                    <div class="col-6">
                        <label class="form-label">State</label>
                        <input type="text" th:field="*{patientProfile.state}" class="form-control" required/>
                    </div>
                </div>
                <div class="mb-3 row">
                    <div class="col-6">
                        <label class="form-label">Country</label>
                        <input type="text" th:field="*{patientProfile.country}" class="form-control" required/>
                    </div>
                    <div class="col-6">
                        <label class="form-label">Postal/Zip Code</label>
                        <input type="text" th:field="*{patientProfile.zipCode}" class="form-control" required/>
                    </div>
                </div>
                <hr>
                <h6 class="mb-3 mt-2">Payment Details</h6>
                <div class="mb-3">
                    <label class="form-label">Cardholder Name</label>
                    <input type="text" th:field="*{patientProfile.cardName}" class="form-control" required/>
                </div>
                <div class="mb-3 row">
                    <div class="col-8">
                        <label class="form-label">Card Number</label>
                        <input type="text" th:field="*{patientProfile.cardNumber}" maxlength="19" class="form-control" required/>
                    </div>
                    <div class="col-4">
                        <label class="form-label">CVV</label>
                        <input type="text" th:field="*{patientProfile.cvv}" maxlength="4" class="form-control" required/>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Emergency Contact Number</label>
                    <input type="text" th:field="*{patientProfile.emergencyContact}" class="form-control"/>
                </div>
                <button type="button" class="btn btn-secondary back-btn" onclick="prevStep()">Back</button>
                <button type="submit" class="btn btn-success next-btn">Sign Up</button>
            </div>
        </form>
    </div>
</div>
<div class="background-img-side"></div>

<script>
    let currentStep = 1;
    function nextStep() {
        document.getElementById('step' + currentStep).classList.remove('active');
        currentStep++;
        document.getElementById('step' + currentStep).classList.add('active');
    }
    function prevStep() {
        document.getElementById('step' + currentStep).classList.remove('active');
        currentStep--;
        document.getElementById('step' + currentStep).classList.add('active');
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
